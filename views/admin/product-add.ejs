<%- include('../../views/partials/admin/header') %>

<body>
<style>
  /* Kaizen custom styles */
  .form-control, .form-select {
    border-radius: 8px;
    border: 1px solid #ccc;
    transition: border-color 0.3s ease;
  }
  .form-control:focus, .form-select:focus {
    border-color: #6c63ff;
    box-shadow: 0 0 0 0.1rem rgba(108, 99, 255, 0.25);
  }
  .btn-primary {
    background-color: #6c63ff;
    border-color: #6c63ff;
    transition: 0.3s;
  }
  .btn-primary:hover {
    background-color: #584fd0;
    border-color: #584fd0;
  }
  .btn-secondary {
    background-color: #f0f0f0;
    color: #333;
    border: 1px solid #ccc;
  }
  .btn-secondary:hover {
    background-color: #e1e1e1;
  }
  .card {
    border: none;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.05);
    border-radius: 12px;
  }

  /* Image-slot base */
  .image-slot {
    border: 2px dashed #ccc;
    border-radius: 8px;
    background-color: #f9f9f9;
    width: 100%;
    max-width: 200px;
    height: 150px;
    position: relative;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    margin: 0.5rem 0;
    overflow: hidden;
  }
  .image-slot img {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: contain;   
    opacity: 0.6;
    transition: object-fit 0.3s ease, opacity 0.3s ease;
  }
  .image-slot.has-image img {
    object-fit: cover;   
    opacity: 1;
  }
  .image-slot .btn {
    margin-top: 0.5rem;
    padding: 4px 8px;
    font-size: 0.85rem;
    background-color: #6c63ff;
    color: #fff;
    border: none;
    border-radius: 4px;
  }
  #img-error {
    font-size: 0.9rem;
  }
  .crop-container {
    background: #fff;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .modal-dialog.modal-xl { max-width: 90%; }
  .modal-content {
    height: 85vh;
    display: flex;
    flex-direction: column;
    border-radius: 12px;
  }
  .modal-body {
    flex: 1;
    min-height: 70vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
  }
  #cropImage {
    max-width: 90vw;
    max-height: 60vh;
    border-radius: 8px;
  }
</style>

  <aside class="navbar-aside" id="offcanvas_aside">
    <div class="aside-top">
      <a href="/admin" class="brand-wrap">
        <img src="/assets2/imgs/theme/kaizenlogoo.svg" class="logo" alt="Kaizen Dashboard">
      </a>
      <div>
        <button class="btn btn-icon btn-aside-minimize">
          <i class="text-muted material-icons md-menu_open"></i>
        </button>
      </div>
    </div>
    <nav>
      <ul class="menu-aside">
        <li class="menu-item">
          <a class="menu-link" href="/admin">
            <i class="icon material-icons md-home"></i>
            <span class="text">Dashboard</span>
          </a>
        </li>
        <li class="menu-item active">
          <a class="menu-link" href="/admin/addProducts">
            <i class="icon material-icons md-add_box"></i>
            <span class="text">Product Add</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <main class="main-wrap">
    <header class="main-header navbar">
      <div class="col-search mb-3"></div>
      <div class="col-nav">
        <ul class="nav">
          <li class="dropdown nav-item">
            <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount">
              <img class="img-xs rounded-circle" src="/assets2/imgs/people/avatar2.jpg" alt="Admin">
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
              <a class="dropdown-item text-danger" href="/admin/logout">
                <i class="material-icons md-exit_to_app"></i>Logout
              </a>
            </div>
          </li>
        </ul>
      </div>
    </header>

     <section class="content-main">
      <div class="col-search mb-3">
        <h2 class="content-title card-title">Add New Product</h2>
      </div>

      <% if (message) { %>
        <div class="alert alert-success text-center mt-2"><%= message %></div>
      <% } %>
      <% if (error) { %>
        <div class="alert alert-danger text-center mt-2"><%= error %></div>
      <% } %>
        <form action="/admin/products/addProducts" method="POST">
  <div class="row">
   
    <div class="col-md-8">
      <div class="card p-4 mb-4">

       
        <div class="mb-3">
          <label for="productName" class="form-label">Product Name</label>
          <input type="text" class="form-control" id="productName" name="productName" required>
        </div>

     
        <div class="mb-3">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" id="description" name="description" rows="4"
            placeholder="Write your description here..."></textarea>
        </div>

      
        <div class="mb-3">
          <label for="specifications" class="form-label">Specifications</label>
          <textarea class="form-control" id="specifications" name="specifications" rows="6"
            placeholder="Enter one spec per line…" required></textarea>
        </div>

        <div class="mb-3">
          <label for="category" class="form-label">Category</label>
          <select class="form-select" id="category" name="category" required>
            <option value="">Select Category</option>
            <% categories.forEach(cat => { %>
              <option value="<%= cat._id %>"><%= cat.categoryName %></option>
            <% }) %>
          </select>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="regularPrice" class="form-label">Base Price (₹)</label>
            <input type="number" step="0.01" class="form-control" id="regularPrice"
                   name="regularPrice" placeholder="0.00" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="productOffer" class="form-label">Discount Percentage (%)</label>
            <input type="number" step="0.01" class="form-control" id="productOffer"
                   name="productOffer" placeholder="0" value="0">
          </div>
        </div>

        
        <input type="hidden" name="discountPrice" id="discountPrice">

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="stock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="stock" name="stock"
                   placeholder="Enter stock limit" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="size" class="form-label">Size</label>
            <select class="form-select" id="size" name="size" required>
              <option value="">Select Size</option>
              <option value="S">S</option>
              <option value="M">M</option>
              <option value="L">L</option>
              <option value="XL">XL</option>
              <option value="XXL">XXL</option>
            </select>
          </div>
        </div>
        <div class="mb-3">
          <label for="status" class="form-label">Status</label>
          <select class="form-select" id="status" name="status" required>
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
          </select>
        </div>

   
        <div class="d-flex justify-content-center mt-4">
          <button type="submit" class="btn btn-primary px-4" id="submitBtn" disabled>
            Add Product
          </button>
          <a href="/admin/products" class="btn btn-secondary ms-3">Cancel</a>
        </div>
      </div>
    </div>
 
    <div class="col-md-4">
      <div class="card p-4">
        <label class="form-label mb-3">Edit Photos</label>
        <div class="d-flex flex-column align-items-center">
          <% for (let i = 0; i < 3; i++) { %>
            <div class="image-slot" id="slot-<%= i %>" onclick="triggerFile('<%= i %>')">
              <img src="/assets2/imgs/theme/placeholder.svg" alt="placeholder">
              <button type="button" class="btn">Add Image</button>
            </div>
            <input type="file" id="fileInput<%= i %>" accept="image/*" style="display:none"
                   onchange="loadCropper(event, '<%= i %>')">
            <input type="hidden" name="images" id="croppedImage<%= i %>">
          <% } %>
          <div id="img-error" class="text-danger mt-1">
            Please upload & crop all 3 images.
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
    </section>
    
    <%- include('../../views/partials/admin/footer') %>
 