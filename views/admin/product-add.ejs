<%- include('../../views/partials/admin/header') %>

  <body>
    <div class="screen-overlay" id="screenOverlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
      <div class="aside-top">
        <a href="#" class="brand-wrap">
          <img src="/assets2/imgs/theme/kaizenlogoo.svg" class="logo" alt="Kaizen Dashboard">
        </a>
        <div>
          <button class="btn btn-icon btn-aside-minimize">
            <i class="text-muted material-icons md-menu_open"></i>
          </button>
        </div>
      </div>
      <nav>
        <ul class="menu-aside">
          <li class="menu-item">
            <a class="menu-link" href="/admin">
              <i class="icon material-icons md-home"></i>
              <span class="text">Dashboard</span>
            </a>
          </li>
          <li class="menu-item">
            <a class="menu-link" href="/admin/user"> <i class="icon material-icons md-person"></i>
              <span class="text">Customers</span>
            </a>
          </li>
          <li class="menu-item">
            <a class="menu-link" href="/admin/category"> <i class="icon material-icons md-store"></i>
              <span class="text">Category</span>
            </a>
          </li>
          <li class="menu-item has-submenu active">
            <a class="menu-link"><i class="icon material-icons md-shopping_bag"></i>
              <span class="text">Products</span>
            </a>
            <div class="submenu">
              <a href="/admin/addProducts">Product Add</a>
              <a href="/admin/products">Product List</a>
            </div>
          </li>
          <li class="menu-item">
            <a class="menu-link" href="/admin/orders">
              <i class="icon material-icons md-shopping_cart"></i>
              <span class="text">Orders</span>
            </a>
          </li>
          <li class="menu-item">
            <a class="menu-link" href="/admin/transactions">
              <i class="icon material-icons md-account_balance_wallet"></i>
              <span class="text">Transactions</span>
            </a>
          </li>
          <li class="menu-item ">
            <a class="menu-link" href="/admin/coupons">
              <i class="icon material-icons md-local_offer"></i>
              <span class="text">Coupons</span>
            </a>
          </li>
          <li class="menu-item">
            <a class="menu-link" href="/admin/sales-report">
              <i class="icon material-icons md-assessment"></i>
              <span class="text">Sales Report</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <main class="main-wrap">
      <header class="main-header navbar">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
          <i class="fas fa-bars"></i>
        </button>
        <div class="col-search"></div>
      </header>

      <div class="logout-fixed">
        <ul class="nav">
          <li class="dropdown nav-item">
            <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount">
              <img class="img-xs rounded-circle" src="/assets2/imgs/theme/adminAvatar.svg" alt="Admin">
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
              <a class="dropdown-item text-danger" href="/admin/logout">
                <i class="material-icons md-exit_to_app"></i>Logout
              </a>
            </div>
          </li>
        </ul>
      </div>

      <section class="content-main">
        <div class="col-search mb-3">
          <h2 class="content-title card-title">Add New Product</h2>
        </div>

        <form action="/admin/addProducts" method="POST">
          <div class="row">

            <div class="col-md-8">
              <div class="card p-4 mb-4">


                <div class="mb-3">
                  <label for="productName" class="form-label">Product Name</label>
                  <input type="text" class="form-control" id="productName" name="productName" required>
                </div>


                <div class="mb-3">
                  <label for="description" class="form-label">Description</label>
                  <textarea class="form-control" id="description" name="description" rows="4"
                    placeholder="Write your description here..."></textarea>
                </div>


                <div class="mb-3">
                  <label for="specifications" class="form-label">Specifications</label>
                  <textarea class="form-control" id="specifications" name="specifications" rows="6"
                    placeholder="Enter one spec per line…" required></textarea>
                </div>

                <div class="mb-3">
                  <label for="category" class="form-label">Category</label>
                  <select class="form-select" id="category" name="category" required>
                    <option value="">Select Category</option>
                    <% categories.forEach(cat=> { %>
                      <option value="<%= cat._id %>">
                        <%= cat.categoryName %>
                      </option>
                      <% }) %>
                  </select>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="regularPrice" class="form-label">Base Price (₹)</label>
                    <input type="number" step="0.01" class="form-control" id="regularPrice" name="regularPrice"
                      placeholder="0.00" required>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="productOffer" class="form-label">Discount Percentage (%)</label>
                    <input type="number" step="0.01" class="form-control" id="productOffer" name="productOffer"
                      placeholder="0" value="0">
                  </div>
                </div>


                <input type="hidden" name="discountPrice" id="discountPrice">

                <div class="mb-3">
                  <label class="form-label">Stock by Size</label>
                  <div class="row">
                    <% ['S', 'M' , 'L' , 'XL' , 'XXL' ].forEach(size=> { %>
                      <div class="col-md-2">
                        <label>
                          <%= size %>
                        </label>
                        <input type="number" name="stock_<%= size %>" id="stock_<%= size %>" class="form-control"
                          min="0" value="0">
                      </div>
                      <% }) %>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="status" class="form-label">Status</label>
                  <select class="form-select" id="status" name="status" required>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                  </select>
                </div>


                <div class="d-flex justify-content-center mt-4">
                  <button type="submit" class="btn btn-primary px-4" id="submitBtn" disabled>
                    Add Product
                  </button>
                  <a href="/admin/products" class="btn btn-secondary ms-3">Cancel</a>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card p-4">
                <label class="form-label mb-3">Edit Photos</label>
                <div class="d-flex flex-column align-items-center">
                  <% for (let i=0; i < 3; i++) { %>
                    <div class="image-slot" id="slot-<%= i %>" onclick="triggerFile('<%= i %>')">
                      <img
                        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='150'%3E%3Crect fill='%23f0f0f0' width='200' height='150'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='%23999' font-size='14'%3E%3C/text%3E%3C/svg%3E"
                        alt="placeholder">
                      <button type="button" class="btn">Add Image</button>
                    </div>
                    <input type="file" id="fileInput<%= i %>" accept="image/*" style="display:none"
                      onchange="loadCropper(event, '<%= i %>')">
                    <% } %>
                      <div id="img-error" class="text-danger mt-1">
                        Upload & crop all 3 images.
                      </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </section>

      <%- include('../../views/partials/admin/footer') %>