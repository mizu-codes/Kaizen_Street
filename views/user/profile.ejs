<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Profile</title>
  <link rel="shortcut icon" type="image/x-icon" href="/imgs/theme/kaizenicon.svg">
  <link rel="stylesheet" href="/css/main.css?v=3.4">
</head>

<body>

  <header class="header-area header-style-1 header-height-2">
    <div class="header-top header-top-ptb-1 d-none d-lg-block">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-xl-3 col-lg-4">
            <div class="header-info">
            </div>
          </div>
          <div class="col-xl-6 col-lg-4">
            <div class="text-center">
            </div>
          </div>
          <div class="col-xl-3 col-lg-4">
            <div class="header-info header-info-right">
              <% if (user) { %>
                <div class="dropdown">
                  <a href="#" class="sign-in-link">
                    <%= user.name %>
                  </a>
                </div>
                <% } else { %>
                  <ul>
                    <li>
                      <i class="fi-rs-user"></i>
                      <a href="/login">Log In</a>
                    </li>
                  </ul>
                  <% } %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-middle header-middle-ptb-1 d-none d-lg-block">
      <div class="container">
        <div class="header-wrap">
          <div class="logo logo-width-1">
            <a href="/"><img src="/imgs/theme/kaizenlogoo.svg" alt="logo"></a>
          </div>
          <div class="header-right">
            <div class="search-style-2"></div>
            <div class="header-action-right">
              <div class="header-action-2">
                <div class="header-action-icon-2">
                  <a href="/wishlist">
                    <img class="svgInject" alt="Evara" src="/imgs/theme/icons/icon-heart.svg">
                    <span id="wishlistItemCount" class="pro-count blue">
                                            <%= typeof locals.wishlistItemCount !== 'undefined' ? locals.wishlistItemCount : 0 %>
                                        </span>
                  </a>
                </div>
                <div class="header-action-icon-2">
                  <a class="mini-cart-icon" href="/cart">
                    <img alt="Evara" src="/imgs/theme/icons/icon-cart.svg">
                    <span id="cartItemCount" class="pro-count blue">
                                            <%= typeof locals.cartItemCount !=='undefined' ? locals.cartItemCount : 0 %>
                                        </span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-bottom header-bottom-bg-color sticky-bar">
      <div class="container">
        <div class="header-wrap header-space-between position-relative">
          <div class="logo logo-width-1 d-block d-lg-none">
            <a href="/"><img src="/imgs/theme/kaizenlogoo.svg" alt="logo"></a>
          </div>
          <div class="header-nav d-none d-lg-flex">
            <div class="main-menu main-menu-padding-1 main-menu-lh-2 d-none d-lg-block">
              <nav>
                <ul>
                  <li><a href="/">Home</a></li>
                  <li><a href="/shop">Shop</a></li>
                </ul>
              </nav>
            </div>
          </div>
          <div class="header-action-right d-block d-lg-none">
            <div class="header-action-2">
              <div class="header-action-icon-2">
                <a href="/wishlist">
                  <img alt="Evara" src="/imgs/theme/icons/icon-heart.svg">
                  <span id="wishlistItemCount" class="pro-count blue">
                                            <%= typeof locals.wishlistItemCount !== 'undefined' ? locals.wishlistItemCount : 0 %>
                                        </span>
                </a>
              </div>
              <div class="header-action-icon-2">
                <a class="mini-cart-icon" href="/cart">
                  <img alt="Evara" src="/imgs/theme/icons/icon-cart.svg">
                  <span id="cartItemCount" class="pro-count blue">
                                            <%= typeof locals.cartItemCount !=='undefined' ? locals.cartItemCount : 0 %>
                                        </span>
                </a>
              <div class="header-action-icon-2 d-block d-lg-none">
                <div class="burger-icon burger-icon-white">
                  <span class="burger-icon-top"></span>
                  <span class="burger-icon-mid"></span>
                  <span class="burger-icon-bottom"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="page-header breadcrumb-wrap">
    <div class="container">
      <div class="breadcrumb" aria-label="Breadcrumb navigation">
        <a href="/" rel="nofollow">Home</a>
        <span></span> User Profile
      </div>
    </div>
  </div>

 <div class="profile-container">
    <div class="profile-layout">
      <button class="mobile-sidebar-toggle" onclick="toggleSidebar()">
        <span>
          <i class="fi-rs-menu"></i>
          My Account Menu
        </span>
        <i class="fi-rs-angle-down toggle-icon"></i>
      </button>

      <aside class="profile-sidebar" id="profileSidebar">
        <h4>My Account</h4>
        <ul>
          <li>
            <a href="/userProfile" class="active">
              <i class="fi-rs-user"></i> My Profile
            </a>
          </li>
          <li>
            <a href="/orders">
              <i class="fi-rs-shopping-bag"></i> My Orders
            </a>
          </li>
          <li>
            <a href="/profile/addresses">
              <i class="fi-rs-marker"></i> My Addresses
            </a>
          </li>
          <li>
            <a href="/wallet">
              <i class="fi-rs-credit-card"></i> My Wallet
            </a>
          </li>
            <li>
            <a href="/profile/coupons">
              <i class="fi-rs-badge"></i> My Coupons
            </a>
          </li>
          <li>
            <a href="/profile/security">
              <i class="fi-rs-shield-check"></i> Security Settings
            </a>
          </li>
          <li>
            <a href="/logout">
              <i class="fi-rs-sign-out"></i> Logout
            </a>
          </li>
        </ul>
      </aside>

    <main class="profile-content">
        <div class="profile-header">
            <div class="welcome-section">
                <div class="profile-avatar-container">
                    <img src="<%= user.avatarUrl || '/imgs/theme/profileAvatar.png' %>" alt="Profile Image"
                        class="profile-avatar" />
                </div>

                <h1>Welcome, <%= user.name %>!</h1>
                <p class="subtitle">Manage your profile, addresses, and orders</p>

                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-number">
                            <%= orderCount %>
                        </div>
                        <div class="stat-label">Orders</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">
                            <%= addressCount %>
                        </div>
                        <div class="stat-label">Addresses</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">
                            <%= user.totalReferrals || 0 %>
                        </div>
                        <div class="stat-label">Referrals</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="profile-body">
            <div class="profile-section">
                <h3><i class="fi-rs-user"></i> Personal Information</h3>

                <div class="profile-info-grid">
                    <div class="profile-info-section">
                        <h4 style="color: #3BB77E; margin-bottom: 1rem;">Basic Details</h4>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Full Name:</span>
                            <span class="profile-info-value">
                                <%= user.name %>
                            </span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Email:</span>
                            <span class="profile-info-value">
                                <%= user.email %>
                            </span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Phone:</span>
                            <span class="profile-info-value">
                                <%= user.phone || 'Not provided' %>
                            </span>
                        </div>
                    </div>

                    <div class="profile-info-section">
                        <h4 style="color: #3BB77E; margin-bottom: 1rem;">Account Details</h4>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Member Since:</span>
                            <span class="profile-info-value">
                                <%= user.createdAt ? user.createdAt.toLocaleDateString() : 'Recently' %>
                            </span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Account Status:</span>
                            <span class="profile-info-value" style="color: #3BB77E; font-weight: 600;">Active</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Verification:</span>
                            <span class="profile-info-value" style="color: #3BB77E; font-weight: 600;">
                                <i class="fi-rs-shield-check"></i> Verified
                            </span>
                        </div>
                        <% if (user.referredBy) { %>
                        <div class="profile-info-row">
                            <span class="profile-info-label">Joined via Referral:</span>
                            <span class="profile-info-value" style="color: #3BB77E; font-weight: 600;">
                                <i class="fi-rs-gift"></i> Yes
                            </span>
                        </div>
                        <% } %>
                    </div>
                </div>

                <div class="action-buttons">
                    <a href="/profile/edit" class="btn btn-outline-primary edit-btn">
                        <i class="fi-rs-edit"></i> Edit Profile
                    </a>
                </div>
            </div>
            
            <div class="profile-section">
                <h3><i class="fi-rs-gift"></i> Refer a Friend</h3>
                
                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 2rem; margin: 1rem 0;">
                    <p style="margin: 0 0 1.5rem 0; color: #6c757d; font-size: 0.95rem;">
                        Share your referral code with friends and earn rewards!
                    </p>
                    
                    <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                        <div style="width: 200px;">
                            <input 
                                type="text" 
                                value="<%= user.referalCode || 'LOADING...' %>" 
                                readonly 
                                id="referralCodeInput"
                                style="
                                    width: 100%; 
                                    padding: 0.75rem 1rem; 
                                    border: 1px solid #ced4da; 
                                    border-radius: 4px; 
                                    background: white; 
                                    font-family: monospace; 
                                    font-size: 1.1rem; 
                                    font-weight: bold; 
                                    letter-spacing: 0.1em;
                                    text-align: center;
                                    color: #495057;
                                "
                            />
                        </div>
                        
                        <button 
                            id="copyReferralBtn" 
                            style="
                                padding: 0.75rem 1.5rem; 
                                background: #3BB77E; 
                                color: white; 
                                border: none; 
                                border-radius: 4px; 
                                cursor: pointer; 
                                font-weight: 500;
                                transition: background-color 0.2s;
                            "
                            onmouseover="this.style.background='#2a9559'"
                            onmouseout="this.style.background='#3BB77E'"
                        >
                            <i class="fi-rs-copy"></i> Copy
                        </button>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 1rem; background: #e7f3ff; border-radius: 4px; border-left: 4px solid #0066cc;">
                        <small style="color: #004499; display: block;">
                            <strong>How it works:</strong> When someone signs up with your code, they get ₹100 in their wallet instantly!
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </main>
    </div>
</div>

<footer class="main">
    <section class="newsletter p-30 text-white wow fadeIn animated">
        <div class="floating-elements">
            <div class="floating-element">桜</div>
            <div class="floating-element">桜</div>
            <div class="floating-element">⚡</div>
            <div class="floating-element">🌸</div>
        </div>
    </section>

    <section class="section-padding footer-mid">
        <div class="container pt-15 pb-20">
            <div class="row">
                <div class="col-lg-4 col-md-6">
                    <div class="footer-logo mb-20">
                        <a><img src="/imgs/theme/kaizenlogoo.svg" alt="Kaizen Logo"></a>
                    </div>
                    <div class="widget-about font-md mb-md-5 mb-lg-0">
                        <div class="brand-story wow fadeIn animated">
                            <p class="text-grey-4 mb-15">
                                <strong>Kaizen</strong> (改善) — Japanese philosophy of continuous improvement and
                                evolution. We embody this principle in every stitch, every design, and every collection.
                            </p>
                            <p class="text-grey-4 mb-20">
                                From streetwear roots to evolving aesthetics, Kaizen represents the relentless pursuit
                                of perfection. We don't just create clothing; we evolve culture, one piece at a time.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3">
                    <h5 class="widget-title wow fadeIn animated">Quick Links</h5>
                    <ul class="footer-list wow fadeIn animated mb-sm-5 mb-md-0">
                        <li><a href="/">Home</a></li>
                        <li><a href="/shop">Shop</a></li>
                        <li><a href="/cart">Cart</a></li>
                        <li><a href="/wishlist">Wishlist</a></li>
                    </ul>
                </div>

                <div class="col-lg-2 col-md-3">
                    <h5 class="widget-title wow fadeIn animated">My Account</h5>
                    <ul class="footer-list wow fadeIn animated">
                        <li><a href="/userProfile">My Profile</a></li>
                        <li><a href="/profile/coupons">View Coupons</a></li>
                        <li><a href="/wallet">Open Wallet</a></li>
                        <li><a href="/orders">Track My Order</a></li>
                        <li><a href="/profile/addresses">View Address</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 col-md-6">
                    <h5 class="widget-title wow fadeIn animated">Contact</h5>
                    <div class="widget-about font-md mb-md-5 mb-lg-0 wow fadeIn animated">
                        <p class="wow fadeIn animated">
                            <strong>Address:</strong> Kannur, Kerala
                        </p>
                        <p class="wow fadeIn animated">
                            <strong>Phone:</strong> +91 9000 123 456 / +91 484 555 0123
                        </p>
                        <p class="wow fadeIn animated">
                            <strong>Hours:</strong> 10:00 - 21:00, Mon - Sun
                        </p>
                    </div>

                    <div class="payment-section mt-30">
                        <p class="mb-15 fw-600 text-grey-4 wow fadeIn animated">Secured Payment Methods</p>
                        <div class="payment-methods wow fadeIn animated d-flex align-items-center gap-3">
                            <div class="payment-method-item">
                                <img src="/imgs/theme/COD-icon.png" alt="COD" style="height: 55px;">
                            </div>
                            <div class="payment-method-item">
                                <img src="/imgs/theme/wallet-icon.png" alt="Wallet" style="height: 60px;">
                            </div>
                            <div class="payment-method-item">
                                <img src="/imgs/theme/razorpay-icon.png" alt="Razorpay" style="height: 55px;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="container pb-20 wow fadeIn animated">
        <div class="row">
            <div class="col-12">
                <hr class="footer-divider mb-3">
            </div>
            <div class="col-lg-6 col-md-6">
                <p class="text-md-start text-center font-sm text-muted mb-0">
                    &copy; <span id="year"></span> <strong class="text-brand">Kaizen Street</strong>. All rights
                    reserved.
                </p>
            </div>
            <div class="col-lg-6 col-md-6">
                <p class="text-md-end text-center font-sm text-muted mb-0">
                    Designed with <span class="text-brand">❤</span>
                </p>
            </div>
        </div>
    </div>
</footer>

  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.bundle.min.js"></script>
  <script src="/js/wishlist-count-updater.js"></script>
<script src="/js/cart-count-updater.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
</script>


<script>
    const section = document.querySelector('.newsletter');

    window.addEventListener('scroll', () => {
        const rect = section.getBoundingClientRect();
        const topOfPage = window.pageYOffset;
        const topOfSec = rect.top + topOfPage;
        const scrolled = topOfPage - topOfSec;
        const distance = Math.max(scrolled, 0);
        const yPos = distance * -0.5;
    });
</script>

  <script>
    function toggleSidebar() {
      const sidebar = document.getElementById('profileSidebar');
      const toggle = document.querySelector('.mobile-sidebar-toggle');

      sidebar.classList.toggle('show');
      toggle.classList.toggle('active');
    }

    document.addEventListener('click', function (event) {
      const sidebar = document.getElementById('profileSidebar');
      const toggle = document.querySelector('.mobile-sidebar-toggle');

      if (window.innerWidth <= 991 &&
        !sidebar.contains(event.target) &&
        !toggle.contains(event.target) &&
        sidebar.classList.contains('show')) {
        sidebar.classList.remove('show');
        toggle.classList.remove('active');
      }
    });

    window.addEventListener('resize', function () {
      const sidebar = document.getElementById('profileSidebar');
      const toggle = document.querySelector('.mobile-sidebar-toggle');

      if (window.innerWidth > 991) {
        sidebar.classList.remove('show');
        toggle.classList.remove('active');
      }
    });

  document.addEventListener('DOMContentLoaded', function() {
    const copyBtn = document.getElementById('copyReferralBtn');
    const referralCodeInput = document.getElementById('referralCodeInput');
    
    copyBtn.addEventListener('click', function() {
        referralCodeInput.select();
        referralCodeInput.setSelectionRange(0, 99999); 
        
        navigator.clipboard.writeText(referralCodeInput.value).then(function() {
            const originalText = copyBtn.innerHTML;
            const originalBg = copyBtn.style.background;
            
            copyBtn.innerHTML = '<i class="fi-rs-check"></i> Copied!';
            copyBtn.style.background = '#28a745';
            
            setTimeout(function() {
                copyBtn.innerHTML = originalText;
                copyBtn.style.background = originalBg;
            }, 2000);
        }).catch(function(err) {
            try {
                document.execCommand('copy');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fi-rs-check"></i> Copied!';
                copyBtn.style.background = '#28a745';
                
                setTimeout(function() {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = '#3BB77E';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy: ', err);
            }
        });
    });
   
    referralCodeInput.addEventListener('click', function() {
        this.select();
    });
});

function toggleSidebar() {
    const sidebar = document.getElementById('profileSidebar');
    sidebar.classList.toggle('show');
}
  </script>
</body>

</html>